(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-center-bindMobile"],{2271:function(e,t,a){"use strict";a.r(t);var n=a("6662"),s=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=s.a},"3e0b":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"u-code-wrap"})},r=[]},5151:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 下方引入的为uView UI的集成样式文件，为scss预处理器，其中包含了一些"u-"开头的自定义变量\r\n * uView自定义的css类名和scss变量，均以"u-"开头，不会造成冲突，请放心使用 \r\n */\r\n/* 页面左右间距 */\r\n/* 文字尺寸 */\r\n/* 边框颜色 */\r\n/* 图片加载中颜色 */\r\n/* 行为相关颜色 */\r\n/*文字颜色*/.u-code-wrap[data-v-7412e1a8]{width:0;height:0;position:fixed;z-index:-1}',""]),e.exports=t},"5a2e":function(e,t,a){"use strict";a.r(t);var n=a("db53"),s=a.n(n);for(var r in n)"default"!==r&&function(e){a.d(t,e,(function(){return n[e]}))}(r);t["default"]=s.a},6662:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){var e=this;return{model:{setting:uni.getStorageSync("setting"),mobile:"",code:"",password:"",rePassword:"",pay_password:"",repay_password:""},codeTips:"",border:!1,labelPosition:"left",errorType:["toast"],show:!1,rulesgetCode:{mobile:[{required:!0,message:this.app.langReplace("请输入手机号"),trigger:["change","blur"]},{validator:function(t,a,n){return e.$u.test.mobile(a)},message:this.app.langReplace("手机号码不正确"),trigger:["change","blur"]}]},rules:{mobile:[{required:!0,message:this.app.langReplace("请输入手机号"),trigger:["change","blur"]},{validator:function(t,a,n){return e.$u.test.mobile(a)},message:this.app.langReplace("手机号码不正确"),trigger:["change","blur"]}],code:[{min:6,required:!0,message:this.app.langReplace("请输入6位验证码"),trigger:["change","blur"]},{type:"number",message:this.app.langReplace("验证码只能为数字"),trigger:["change","blur"]}],password:[{required:!0,message:this.app.langReplace("请输入密码"),trigger:["change","blur"]},{min:8,message:this.app.langReplace("密码不能少于8个字符"),trigger:"change"}],rePassword:[{required:!0,message:this.app.langReplace("请再次输入密码"),trigger:["change","blur"]},{validator:function(t,a,n){return a===e.model.password},message:this.app.langReplace("两次输入的密码不相等"),trigger:["change","blur"]}],pay_password:[{required:!0,message:this.app.langReplace("请输入支付密码"),trigger:["change","blur"]},{min:6,max:6,type:"number",message:this.app.langReplace("支付密码只能为6位数字"),trigger:["change","blur"]}],repay_password:[{required:!0,message:this.app.langReplace("请再次输入支付密码"),trigger:["change","blur"]},{validator:function(t,a,n){return a===e.model.pay_password},message:this.app.langReplace("两次输入的支付密码不相等"),trigger:["change","blur"]}]}}},onLoad:function(e){var t=this.app.langReplace("绑定手机");uni.setNavigationBarTitle({title:t}),this.from=e.from,this.getUserInfo()},computed:{},onReady:function(){},methods:{getUserInfo:function(){var e=this;this.$u.api.getUserInfo().then((function(t){var a=t.data;""!=a.mobile?uni.showModal({title:e.app.langReplace("提示"),content:e.app.langReplace("当前帐号已绑定手机："+a.mobile),confirmText:e.app.langReplace("确认"),showCancel:!1,success:function(e){e.confirm&&uni.redirectTo({url:"index"})}}):e.show=!0}))},submit:function(){var e=this;1!=this.setting.sys_model_pay_password&&(delete this.rules.pay_password,delete this.rules.repay_password),this.$refs.uForm.setRules(this.rules),this.$refs.uForm.validate((function(t){if(!t)return!1;e.$u.post("member/api.users/bindMobile",e.model).then((function(t){if(t.code<0)return e.$u.toast(t.msg),!1;uni.showModal({title:e.app.langReplace("提示"),content:e.app.langReplace("绑定成功"),confirmText:e.app.langReplace("确认"),showCancel:!1,success:function(e){e.confirm&&uni.redirectTo({url:"index"})}})}))}))},codeChange:function(e){this.codeTips=this.app.langReplace(e)},getCode:function(){var e=this;this.$refs.uCode.canGetCode?(this.$refs.uForm.setRules(this.rulesgetCode),this.$refs.uForm.validate((function(t){t&&(uni.showLoading({title:"正在获取验证码",mask:!0}),e.$u.get("publics/api.sms/sendCode",{type:"bind_mobile",mobile:e.model.mobile}).then((function(t){uni.hideLoading(),t.data.code?(e.$u.toast("测试状态，验证码自动填充"),e.model.code=t.data.code,delete e.rules.code):e.$u.toast(e.app.langReplace("验证码已发送")),e.user_exist=t.data.user_exist,e.$refs.uCode.start()})))}))):this.$u.toast(this.app.langReplace("倒计时结束后再请求"))}}};t.default=n},"7a2d":function(e,t,a){"use strict";var n=a("bef7"),s=a.n(n);s.a},a522:function(e,t,a){"use strict";a.r(t);var n=a("df9a"),s=a("2271");for(var r in s)"default"!==r&&function(e){a.d(t,e,(function(){return s[e]}))}(r);var i,o=a("f0c5"),l=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"2db835c7",null,!1,n["a"],i);t["default"]=l.exports},bef7:function(e,t,a){var n=a("5151");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=a("4f06").default;s("c4b741da",n,!0,{sourceMap:!1,shadowMode:!1})},db53:function(e,t,a){"use strict";a("a9e3"),a("ac1f"),a("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"u-verification-code",props:{seconds:{type:[String,Number],default:60},startText:{type:String,default:"获取验证码"},changeText:{type:String,default:"X秒重新获取"},endText:{type:String,default:"重新获取"},keepRunning:{type:Boolean,default:!1},uniqueKey:{type:String,default:""}},data:function(){return{secNum:this.seconds,timer:null,canGetCode:!0}},mounted:function(){this.checkKeepRunning()},watch:{seconds:{immediate:!0,handler:function(e){this.secNum=e}}},methods:{checkKeepRunning:function(){var e=Number(uni.getStorageSync(this.uniqueKey+"_$uCountDownTimestamp"));if(!e)return this.changeEvent(this.startText);var t=Math.floor(+new Date/1e3);this.keepRunning&&e&&e>t?(this.secNum=e-t,uni.removeStorageSync(this.uniqueKey+"_$uCountDownTimestamp"),this.start()):this.changeEvent(this.startText)},start:function(){var e=this;this.timer&&(clearInterval(this.timer),this.timer=null),this.$emit("start"),this.canGetCode=!1,this.changeEvent(this.changeText.replace(/x|X/,this.secNum)),this.setTimeToStorage(),this.timer=setInterval((function(){--e.secNum?e.changeEvent(e.changeText.replace(/x|X/,e.secNum)):(clearInterval(e.timer),e.timer=null,e.changeEvent(e.endText),e.secNum=e.seconds,e.$emit("end"),e.canGetCode=!0)}),1e3)},reset:function(){this.canGetCode=!0,clearInterval(this.timer),this.secNum=this.seconds,this.changeEvent(this.endText)},changeEvent:function(e){this.$emit("change",e)},setTimeToStorage:function(){if(this.keepRunning&&this.timer&&this.secNum>0&&this.secNum<=this.seconds){var e=Math.floor(+new Date/1e3);uni.setStorage({key:this.uniqueKey+"_$uCountDownTimestamp",data:e+Number(this.secNum)})}}},beforeDestroy:function(){this.setTimeToStorage(),clearTimeout(this.timer),this.timer=null}};t.default=n},df9a:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return n}));var n={uForm:a("822d").default,uFormItem:a("e728").default,uInput:a("aee4").default,uVerificationCode:a("ebfa").default},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"page-body",class:[e.app.setCStyle(e.from)]},[e.show?a("u-form",{ref:"uForm",attrs:{model:e.model,errorType:e.errorType}},[a("v-uni-view",{staticClass:"pbox bg-white mlr20 mt22 br20 mt30"},[a("u-form-item",{attrs:{rightIconStyle:{color:"#888",fontSize:"32rpx"},"right-icon":"phone","label-position":e.labelPosition,label:e.app.langReplace("手机号码"),prop:"mobile","label-width":"180"}},[a("u-input",{attrs:{border:e.border,placeholder:e.app.langReplace("请输入手机号"),type:"number"},model:{value:e.model.mobile,callback:function(t){e.$set(e.model,"mobile",t)},expression:"model.mobile"}})],1),a("u-form-item",{attrs:{"label-position":e.labelPosition,label:e.app.langReplace("验证码"),prop:"code","label-width":"180"}},[a("u-input",{attrs:{border:e.border,placeholder:e.app.langReplace("请输入验证码"),type:"text"},model:{value:e.model.code,callback:function(t){e.$set(e.model,"code",t)},expression:"model.code"}}),a("v-uni-button",{staticClass:"bg-base color-ff",attrs:{slot:"right",type:"success",size:"mini"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getCode.apply(void 0,arguments)}},slot:"right"},[e._v(e._s(e.codeTips))])],1),a("u-form-item",{attrs:{"label-position":e.labelPosition,label:e.app.langReplace("密码"),prop:"password","label-width":"180"}},[a("u-input",{attrs:{"password-icon":!0,border:e.border,type:"password",placeholder:e.app.langReplace("请输入密码")},model:{value:e.model.password,callback:function(t){e.$set(e.model,"password",t)},expression:"model.password"}})],1),a("u-form-item",{attrs:{"label-position":e.labelPosition,label:e.app.langReplace("确认密码"),"label-width":"180",prop:"rePassword"}},[a("u-input",{attrs:{border:e.border,type:"password",placeholder:e.app.langReplace("请再次输入密码")},model:{value:e.model.rePassword,callback:function(t){e.$set(e.model,"rePassword",t)},expression:"model.rePassword"}})],1),1==e.setting.sys_model_pay_password?[a("u-form-item",{attrs:{"label-position":e.labelPosition,label:e.app.langReplace("支付密码"),prop:"pay_password","label-width":"180"}},[a("u-input",{attrs:{"password-icon":!0,border:e.border,type:"password",placeholder:e.app.langReplace("请输入支付密码")},model:{value:e.model.pay_password,callback:function(t){e.$set(e.model,"pay_password",t)},expression:"model.pay_password"}})],1),a("u-form-item",{attrs:{"label-position":e.labelPosition,label:e.app.langReplace("确认支付密码"),"label-width":"180",prop:"repay_password"}},[a("u-input",{attrs:{border:e.border,type:"password",placeholder:e.app.langReplace("请再次输入支付密码")},model:{value:e.model.repay_password,callback:function(t){e.$set(e.model,"repay_password",t)},expression:"model.repay_password"}})],1)]:e._e()],2),a("v-uni-view",{staticClass:"pbox mt50"},[a("v-uni-button",{staticClass:"primarybtn",attrs:{size:"default",shape:"circle",type:"warning"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v(e._s(e.app.langReplace("绑定手机")))])],1),a("u-verification-code",{ref:"uCode",attrs:{seconds:"60"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.codeChange.apply(void 0,arguments)}}})],1):e._e()],1)},r=[]},ebfa:function(e,t,a){"use strict";a.r(t);var n=a("3e0b"),s=a("5a2e");for(var r in s)"default"!==r&&function(e){a.d(t,e,(function(){return s[e]}))}(r);a("7a2d");var i,o=a("f0c5"),l=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"7412e1a8",null,!1,n["a"],i);t["default"]=l.exports}}]);